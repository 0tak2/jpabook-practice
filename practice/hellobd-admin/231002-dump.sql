-- H2 2.2.224; 
;              
CREATE USER IF NOT EXISTS "SA" SALT '029ae22313ae3fa0' HASH '16b4846801a5d045d27f6872fbaac0334e005f3931018f256ed8452f6a35c818' ADMIN;          
CREATE CACHED TABLE "PUBLIC"."ARTICLE"(
    "IS_HIDDEN" BOOLEAN NOT NULL,
    "ARTICLE_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "BOARD_ID" BIGINT NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "UPDATE_DT" TIMESTAMP(6),
    "VIEW_COUNT" BIGINT NOT NULL,
    "AUTHOR_ID" UUID NOT NULL,
    "TITLE" CHARACTER VARYING(255) NOT NULL,
    "CONTENT" CHARACTER LARGE OBJECT NOT NULL
);          
ALTER TABLE "PUBLIC"."ARTICLE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_F" PRIMARY KEY("ARTICLE_ID");               
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ARTICLE;  
CREATE CACHED TABLE "PUBLIC"."ARTICLE_LIKE"(
    "ARTICLE_ID" BIGINT NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "USER_ID" UUID NOT NULL
);    
ALTER TABLE "PUBLIC"."ARTICLE_LIKE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_7" PRIMARY KEY("ARTICLE_ID", "USER_ID");               
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ARTICLE_LIKE;             
CREATE CACHED TABLE "PUBLIC"."BOARD"(
    "BOARD_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 3) NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "UPDATE_DT" TIMESTAMP(6),
    "DESCRIPTION" CHARACTER VARYING(1024) NOT NULL,
    "BOARD_NAME" CHARACTER VARYING(255) NOT NULL
);        
ALTER TABLE "PUBLIC"."BOARD" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_3" PRIMARY KEY("BOARD_ID");   
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.BOARD;    
INSERT INTO "PUBLIC"."BOARD" VALUES
(1, TIMESTAMP '2023-10-02 14:33:54.173489', TIMESTAMP '2023-10-02 14:33:54.17357', U&'\d14c\c2a4\d2b8 1', U&'\d14c\c2a4\d2b8 \ac8c\c2dc\d310 1'),
(2, TIMESTAMP '2023-10-02 14:34:15.175674', TIMESTAMP '2023-10-02 14:34:15.17575', U&'\d14c\c2a4\d2b8 2', U&'\d14c\c2a4\d2b8 \ac8c\c2dc\d310 2');        
CREATE CACHED TABLE "PUBLIC"."BOARD_ADMIN"(
    "BOARD_ADMIN_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 4) NOT NULL,
    "BOARD_ID" BIGINT,
    "CREATE_DT" TIMESTAMP(6),
    "ADMIN_ID" UUID
);    
ALTER TABLE "PUBLIC"."BOARD_ADMIN" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_6" PRIMARY KEY("BOARD_ADMIN_ID");       
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.BOARD_ADMIN;              
INSERT INTO "PUBLIC"."BOARD_ADMIN" VALUES
(1, 1, TIMESTAMP '2023-10-02 14:33:54.218062', UUID '9bc2e8bf-0abf-4396-a07f-c9e351012ef6'),
(2, 1, TIMESTAMP '2023-10-02 14:33:54.246083', UUID '625fc6db-197b-47dd-98f9-57c5ad4e2048'),
(3, 2, TIMESTAMP '2023-10-02 14:34:15.187861', UUID '9bc2e8bf-0abf-4396-a07f-c9e351012ef6');               
CREATE CACHED TABLE "PUBLIC"."COMMENT"(
    "IS_HIDDEN" BOOLEAN NOT NULL,
    "ARTICLE_ID" BIGINT,
    "COMMENT_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "UPDATE_DT" TIMESTAMP(6),
    "AUTHOR_ID" UUID,
    "CONTENT" CHARACTER LARGE OBJECT NOT NULL
);         
ALTER TABLE "PUBLIC"."COMMENT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_63" PRIMARY KEY("COMMENT_ID");              
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.COMMENT;  
CREATE CACHED TABLE "PUBLIC"."COMMENT_LIKE"(
    "COMMENT_ID" BIGINT NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "USER_ID" UUID NOT NULL
);    
ALTER TABLE "PUBLIC"."COMMENT_LIKE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_B" PRIMARY KEY("COMMENT_ID", "USER_ID");               
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.COMMENT_LIKE;             
CREATE CACHED TABLE "PUBLIC"."REPORT"(
    "CREATE_DT" TIMESTAMP(6),
    "REPORT_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "TARGET_ARTICLE_ID" BIGINT,
    "TARGET_COMMENT_ID" BIGINT,
    "UPDATE_DT" TIMESTAMP(6),
    "REPORT_TYPE" CHARACTER VARYING(10),
    "STATUS" CHARACTER VARYING(10),
    "TARGET_TYPE" CHARACTER VARYING(10),
    "REPORTER_USER_ID" UUID,
    "DESCRIPTION" CHARACTER VARYING(1000),
    "RESULT" CHARACTER VARYING(2000)
);       
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8FDF" PRIMARY KEY("REPORT_ID");              
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.REPORT;   
CREATE CACHED TABLE "PUBLIC"."USER_PENALTY"(
    "COUNT" INTEGER NOT NULL,
    "INCREMENT" INTEGER NOT NULL,
    "CREATE_DT" TIMESTAMP(6),
    "REPORT_ID" BIGINT,
    "UPDATE_DT" TIMESTAMP(6),
    "USER_PENALTY_ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "USER_ID" UUID,
    "DESCRIPTION" CHARACTER VARYING(1000)
);        
ALTER TABLE "PUBLIC"."USER_PENALTY" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_B88" PRIMARY KEY("USER_PENALTY_ID");   
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.USER_PENALTY;             
CREATE CACHED TABLE "PUBLIC"."USERS"(
    "IS_ACTIVE" BOOLEAN NOT NULL,
    "BIRTHDAY" TIMESTAMP(6),
    "CREATE_DT" TIMESTAMP(6),
    "UPDATE_DT" TIMESTAMP(6),
    "ROLE" CHARACTER VARYING(10),
    "USER_ID" UUID NOT NULL,
    "NAME" CHARACTER VARYING(48),
    "USERNAME" CHARACTER VARYING(48),
    "PASSWORD" CHARACTER VARYING(128),
    "EMAIL" CHARACTER VARYING(255)
);           
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4D49" PRIMARY KEY("USER_ID"); 
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.USERS;    
INSERT INTO "PUBLIC"."USERS" VALUES
(TRUE, TIMESTAMP '2000-01-01 00:00:00', TIMESTAMP '2023-10-02 14:31:19.167656', TIMESTAMP '2023-10-02 14:31:19.16773', 'SYS_ADMIN', UUID '9bc2e8bf-0abf-4396-a07f-c9e351012ef6', U&'\ad00\b9ac\c790', 'admin', '$2a$10$PszgRhyYhGaAVENT125UTer0SIRNbOoYecdSQwQRp.L9V0RkGXsC2', 'admin@hellobd.org'),
(TRUE, TIMESTAMP '1998-04-08 00:00:00', TIMESTAMP '2023-10-02 14:32:28.351835', TIMESTAMP '2023-10-02 14:32:28.351887', 'USER', UUID 'b076c898-49d0-4147-af4c-0ecddd54604b', U&'\c784\c601\d0dd', 'limo', '$2a$10$PszgRhyYhGaAVENT125UTew.VCWRx1cdlHyswFtdT546bvPywD6rq', 'limorbear@gmail.com'),
(TRUE, TIMESTAMP '2000-01-01 00:00:00', TIMESTAMP '2023-10-02 14:33:26.328682', TIMESTAMP '2023-10-02 14:33:26.328707', 'ADMIN', UUID '625fc6db-197b-47dd-98f9-57c5ad4e2048', U&'\c11c\be44\c2a4 \c5b4\b4dc\bbfc', 'svc_admin1', '$2a$10$PszgRhyYhGaAVENT125UTer0SIRNbOoYecdSQwQRp.L9V0RkGXsC2', 'svc_admin1@hellobd.org');         
CREATE INDEX "PUBLIC"."IDXR43AF9AP4EDM43MMTQ01ODDJ6" ON "PUBLIC"."USERS"("USERNAME" NULLS FIRST);              
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4" CHECK("ROLE" IN('USER', 'ADMIN', 'SYS_ADMIN')) NOCHECK;    
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8" CHECK("REPORT_TYPE" IN('SPAM', 'HATE', 'HARASSMENT', 'OTHER')) NOCHECK;   
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8F" CHECK("STATUS" IN('PENDING', 'RESOLVED', 'REJECTED')) NOCHECK;           
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8FD" CHECK("TARGET_TYPE" IN('ARTICLE', 'COMMENT')) NOCHECK;  
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4D" UNIQUE("USERNAME");       
ALTER TABLE "PUBLIC"."USER_PENALTY" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_B8" UNIQUE("REPORT_ID");               
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4D4" UNIQUE("EMAIL");         
ALTER TABLE "PUBLIC"."COMMENT" ADD CONSTRAINT "PUBLIC"."FKIR20VHRX08EH4ITGPBFXIP0S1" FOREIGN KEY("AUTHOR_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;  
ALTER TABLE "PUBLIC"."BOARD_ADMIN" ADD CONSTRAINT "PUBLIC"."FK96QIAORTA4UJA4N10EUEI0WW0" FOREIGN KEY("BOARD_ID") REFERENCES "PUBLIC"."BOARD"("BOARD_ID") NOCHECK;              
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."FKGTR5RGQT4NJN2UHL48JMTKK54" FOREIGN KEY("TARGET_ARTICLE_ID") REFERENCES "PUBLIC"."ARTICLE"("ARTICLE_ID") NOCHECK;      
ALTER TABLE "PUBLIC"."COMMENT_LIKE" ADD CONSTRAINT "PUBLIC"."FKQLV8PHL1IBEH0EFV4DBN3720P" FOREIGN KEY("COMMENT_ID") REFERENCES "PUBLIC"."COMMENT"("COMMENT_ID") NOCHECK;       
ALTER TABLE "PUBLIC"."COMMENT_LIKE" ADD CONSTRAINT "PUBLIC"."FKL5WRMP8EOY5UEGDO3473JQQI" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;
ALTER TABLE "PUBLIC"."BOARD_ADMIN" ADD CONSTRAINT "PUBLIC"."FKPAW4S971PG5PY0DLFHM2DFHN6" FOREIGN KEY("ADMIN_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;               
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."FKRYCRC7SL64BWYFDRR3RVVLACR" FOREIGN KEY("REPORTER_USER_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;            
ALTER TABLE "PUBLIC"."ARTICLE" ADD CONSTRAINT "PUBLIC"."FKMJGTNY2I22JF4DQNCMD436S0U" FOREIGN KEY("AUTHOR_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;  
ALTER TABLE "PUBLIC"."ARTICLE_LIKE" ADD CONSTRAINT "PUBLIC"."FK4Q8TAF63LE59XLIA82U2MORW1" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;               
ALTER TABLE "PUBLIC"."ARTICLE_LIKE" ADD CONSTRAINT "PUBLIC"."FKABTHLI6G1QJRIUSNIW93PBESW" FOREIGN KEY("ARTICLE_ID") REFERENCES "PUBLIC"."ARTICLE"("ARTICLE_ID") NOCHECK;       
ALTER TABLE "PUBLIC"."ARTICLE" ADD CONSTRAINT "PUBLIC"."FK2Y7W132XB5XP1AIOUIG87AQJO" FOREIGN KEY("BOARD_ID") REFERENCES "PUBLIC"."BOARD"("BOARD_ID") NOCHECK;  
ALTER TABLE "PUBLIC"."USER_PENALTY" ADD CONSTRAINT "PUBLIC"."FKPW0VC0UMAU3PNKSJ1CEPGVNLH" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("USER_ID") NOCHECK;               
ALTER TABLE "PUBLIC"."COMMENT" ADD CONSTRAINT "PUBLIC"."FK5YX0UPHGJC6IK6HB82KKW501Y" FOREIGN KEY("ARTICLE_ID") REFERENCES "PUBLIC"."ARTICLE"("ARTICLE_ID") NOCHECK;            
ALTER TABLE "PUBLIC"."REPORT" ADD CONSTRAINT "PUBLIC"."FKG6TK3R466DFG9H71GWVTS05RX" FOREIGN KEY("TARGET_COMMENT_ID") REFERENCES "PUBLIC"."COMMENT"("COMMENT_ID") NOCHECK;      
ALTER TABLE "PUBLIC"."USER_PENALTY" ADD CONSTRAINT "PUBLIC"."FK7E8Y38IQLDQ7NMMFTYI4UACXO" FOREIGN KEY("REPORT_ID") REFERENCES "PUBLIC"."REPORT"("REPORT_ID") NOCHECK;          
